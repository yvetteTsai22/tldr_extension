(()=>{const e=document.getElementById("summary"),t=document.getElementById("chat-messages"),n=document.getElementById("question-input"),o=document.getElementById("ask-button");function s(e,n){const o=document.createElement("div");o.className=`message ${e}`,o.textContent=n,t.appendChild(o),t.scrollTop=t.scrollHeight}chrome.runtime.onMessage.addListener((t,n,o)=>{"CONTENT_ANALYZED"===t.type&&(e.textContent=t.summary)}),o.addEventListener("click",async()=>{const e=n.value.trim();if(e){s("user",e),n.value="";try{const t=await chrome.tabs.query({active:!0,currentWindow:!0}),n=await chrome.tabs.sendMessage(t[0].id,{type:"GET_CONTENT"});n&&n.content&&chrome.runtime.sendMessage({type:"ASK_QUESTION",question:e,content:n.content},e=>{e&&s("assistant",e)})}catch(e){console.error("Error asking question:",e),s("error","Sorry, I encountered an error while processing your question.")}}}),document.addEventListener("DOMContentLoaded",function(){chrome.tabs.query({active:!0,currentWindow:!0},e=>{chrome.tabs.sendMessage(e[0].id,{type:"GET_CONTENT"},e=>{e&&e.content&&chrome.runtime.sendMessage({type:"ANALYZE_CONTENT",content:e.content})})})})})();